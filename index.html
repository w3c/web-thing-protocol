<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <title>Web Thing Protocol</title>
  <script src="https://www.w3.org/Tools/respec/respec-w3c" class="remove" defer></script>
  <script class="remove">
    // All config options at https://respec.org/docs/
    var respecConfig = {
      specStatus: "CG-DRAFT",
      editors: [{
        name: "Ben Francis",
        company: "Krellian",
        mailto: "ben@krellian.com",
        companyURL: "https://krellian.com",
        w3cid: "51527"
      }],
      github: "w3c/web-thing-protocol",
      shortName: "web-thing-protocol",
      xref: true,
      group: "web-thing-protocol",
      wgPublicList: "public-web-thing-protocol",
      edDraftURI: "https://w3c.github.io/web-thing-protocol/",
      latestVersion: "https://w3c.github.io/web-thing-protocol/"
    };
  </script>
</head>

<body>
  <h1 id="title">Web Thing Protocol</h1>
  <h2 id="subtitle">WebSocket Sub-protocol</h2>

  <section id="abstract">
    <p>This document defines a WebSocket sub-protocol called the Web Thing
      Protocol, for monitoring and controlling connected devices over the
      World Wide Web. The Web Thing Protocol is intended as a dedicated
      real-time protocol for the <a href="https://www.w3.org/WoT/">Web of
        Things</a>, to enable a WoT
      <a href="https://www.w3.org/TR/wot-architecture/#dfn-consumer">Consumer</a>
      to communicate with one or more WoT
      <a href="https://www.w3.org/TR/wot-architecture/#dfn-web-thing">Things</a>
      over a WebSocket connection.
    </p>
  </section>

  <section id="sotd">
    <aside class="ed-note" title="Empty Sections">
      Please note that this document is a work in progress and contains empty
      sections. For an indication of what these sections may eventually contain,
      please see this
      <a href="https://docs.google.com/document/d/1KWv-aQfMgsqBFg0v4rVqzcVvzzisC7y4X4CMUYGc8rE/edit?usp=sharing">strawman
        proposal</a>.
    </aside>
  </section>

  <section id="introduction" class="informative">
    <h2>Introduction</h2>
    <p>This document defines a WebSocket [[WEBSOCKETS-PROTOCOL]] sub-protocol for
      monitoring and controlling connected devices over the Web.
    </p>
    <p>The <a href="https://www.w3.org/WoT/">Web of Things</a> (WoT) is a
      collection of standardised technology building blocks that help provide
      interoperability on the
      <a href="https://en.wikipedia.org/wiki/Internet_of_things">Internet of
        Things</a> (IoT). The WoT Thing Description specification
      [[wot-thing-description11]] defines a metadata format for
      <em>describing</em> the capabilities of &quot;Things&quot; (connected
      devices) on the Web. The WoT Discovery specification [[wot-discovery]]
      defines mechanisms for <em>discovering</em> Things on the Web. This
      specification complements those building blocks by
      defining a dedicated real-time protocol for <em>communicating</em> with Things over the
      Web.
    </p>
    <p>WebSockets [[WEBSOCKETS-PROTOCOL]] provide a way to upgrade a
      standard HTTP [[HTTP11]] request to a full-duplex, persistent, real-time
      communication channel over a single TCP connection. This can be used to
      create a versatile and efficient two-way channel with which a WoT
      <a href="https://www.w3.org/TR/wot-architecture/#dfn-consumer">Consumer</a>
      can communicate with one or more
      <a href="https://www.w3.org/TR/wot-architecture/#dfn-web-thing">Things</a>
      [[wot-architecture11]] to carry out the full set of WoT
      <a href="https://www.w3.org/TR/wot-thing-description/#table-well-known-operation-types">operations</a>.
      However, since a WebSocket is essentially just a raw TCP socket with no
      semantics of its own, a sub-protocol needs to be defined in order for a
      Consumer and Thing to communicate.
    </p>
    <p>Whilst many other <a href="https://www.iana.org/assignments/websocket/websocket.xml#subprotocol-name">WebSocket
        sub-protocols</a> exist, what makes the Web Thing Protocol unique
      is that it is specifically designed around the Web of Things
      <a href="https://www.w3.org/TR/wot-thing-description11/#sec-vocabulary-definition">information
        model</a> and
      <a href="https://www.w3.org/TR/wot-thing-description11/#table-well-known-operation-types">set
        of operations</a> [[wot-thing-description11]], as well as being
      targeted specifically at Web of Things use cases [[wot-usecases]]. It
      can therefore be thought of as being native to the Web of Things.
    </p>
    <p>
      The sub-protocol defines message payload formats for each of the
      well-known
      <a href="https://www.w3.org/TR/wot-thing-description11/#table-well-known-operation-types">
        operation types</a> defined in the WoT
      <a href="https://www.w3.org/TR/wot-architecture/#sec-interaction-model">
        interaction model</a> [[wot-architecture11]], and other messages needed for
      WebSocket communication.
    </p>
    <p>
      This specification is intended to complement deliverables of the
      <a href="https://www.w3.org/WoT/wg/">WoT Working Group</a>, including WoT
      Architecture [[wot-architecture11]], WoT Thing Description
      [[wot-thing-description11]], WoT Discovery [[wot-discovery]],
      WoT Binding Templates [[wot-binding-templates]] and WoT Profile
      [[wot-profile]]. It is intended to implement use cases and requirements
      defined in the
      <a
        href="https://www.w3.org/community/reports/web-thing-protocol/CG-FINAL-web-thing-protocol-requirements-20231101/">Web
        Thing Protocol Use Cases & Requirements</a> community report.
    </p>
    <p>Whilst this document is not on a standards track, the Web Thing Protocol
      is intended to eventually join a standards track at the W3C or another
      standards body such as the IETF.
    </p>
  </section>

  <section id="conformance">
  </section>

  <section id="terminology">
    <h2>Terminology</h2>
    <p>Fundamental WoT terminology such as <dfn>Thing</dfn> or <dfn>Web Thing</dfn>, <dfn>Consumer</dfn> or <dfn>WoT
        Consumer</dfn>, WoT Thing Description or <dfn>Thing Description</dfn>, Interaction Model,
      <dfn>Interaction Affordance</dfn>, <dfn>Property</dfn>, <dfn>Action</dfn> and Event are defined in
      the
      <a href="https://www.w3.org/TR/wot-architecture/#terminology">Terminology</a>
      section of the WoT Architecture specification [[wot-architecture11]].
    </p>
  </section>

  <section id="websocket-connection">
    <h2>WebSocket Connection</h2>
    <section id="protocol-handshake">
      <h3>Protocol Handshake</h3>
      <p>In order to communicate with a <a>Web Thing</a>,
        a WoT <a>Consumer</a> [[wot-architecture11]] MUST
        locate one or more WebSocket [[WEBSOCKETS-PROTOCOL]] endpoints provided by the <a>Thing</a> for a given set of
        <a>Interaction Affordances</a>
        [[wot-thing-description11]].
      </p>
      <p>The URL of a WebSocket endpoint to be used for a given interaction MUST be obtained from a <a>Thing
          Description</a>
        [[wot-architecture11]] by locating a <a href="https://www.w3.org/TR/wot-thing-description/#form">Form</a> inside
        the corresponding <a>Interaction Affordance</a> for which:
      <ul>
        <li>After being resolved against a <a
            href="https://www.w3.org/TR/wot-thing-description/#td-vocab-base--Thing"><code>base</code></a> URL
          [[wot-thing-description11]] where applicable, the URI scheme [[RFC3986]] of the value of its <a
            href="https://www.w3.org/TR/wot-thing-description/#td-vocab-href--Form"><code>href</code></a> member
          [[wot-thing-description11]] is <code>"ws"</code> or &<code>"wss"</code></li>
        <li>Its <a
            href="https://www.w3.org/TR/wot-thing-description/#td-vocab-subprotocol--Form"><code>subprotocol</code></a>
          member has a value of <code>"webthingprotocol"</code></li>
      </ul>
      </p>
      <p>To open a WebSocket on a Thing, an HTTP <a
          href="https://httpwg.org/specs/rfc9110.html#GET"><code>GET</code></a> request [[RFC9110]] MUST be upgraded to
        a WebSocket connection using a standard WebSocket <a
          href="https://www.rfc-editor.org/rfc/rfc6455#page-6">protocol handshake</a> [[WEBSOCKETS-PROTOCOL]],
        specifying the "webthingprotocol" sub-protocol.
      </p>
      <pre class="example" title="WebSocket Protocol Handshake HTTP Request">
        GET wss://mythingserver.com/things/robot
        Host: mythingserver.com
        Origin: https://mythingserver.com
        Upgrade: websocket
        Connection: Upgrade
        Sec-WebSocket-Key: x3JJHMbDL1EzLkh9GBhXDw==
        Sec-WebSocket-Protocol: webthingprotocol
        Sec-WebSocket-Version: 13
      </pre>
      <pre class="example" title="WebSocket Protocol Handshake HTTP Response">
        HTTP/1.1 101 Switching Protocols
        Upgrade: websocket
        Connection: Upgrade
        Sec-WebSocket-Accept: HSmrc0sMlYUkAGmm5OPpG2HaGWk=
        Sec-WebSocket-Protocol: webthingprotocol        
      </pre>
      <p class="ednote" title="Sub-protocol Name">
        Sub-protocol name to be confirmed, see <a href="#iana-considerations">IANA Considerations</a>.
      </p>
      <p class="note">A WebSocket can be opened from a web page using the JavaScript WebSocket API [[WEBSOCKETS-API]]
        which will take care of the handshake detailed above and allow messages to be sent and received.
      </p>
      <pre class="example" title="WebSocket Instantiation in JavaScript">
        const socket = new WebSocket('wss://mywebthingserver/things/robot', 'webthingprotocol');
      </pre>
    </section>

    <section id="websocket-reuse">
      <h3>WebSocket Re-use</h3>
      <p>A single WebSocket [[WEBSOCKETS-PROTOCOL]] connection from a <a>WoT Consumer</a> MAY be shared between multiple
        <a>Interaction
          Affordances</a> of a <a>Thing</a>. A single WebSocket connection from a <a>WoT Consumer</a> MAY also be shared
        between multiple <a>Things</a>.
      </p>
      <p>Before opening a new WebSocket connection, a <a>WoT Consumer</a> SHOULD check whether it already has an open
        connection to the same WebSocket endpoint URL.</p>
      <p>If an existing connection to the same WebSocket endpoint URL exists, then that connection SHOULD be re-used
        rather than opening an additional socket.</p>
      <p>If an existing connection to the same WebSocket endpoint URL exists but is using a different set of credentials
        for its given <a
          href="https://www.w3.org/TR/wot-thing-description11/#securityscheme"><code>SecurityScheme</code></a>
        [[wot-thing-description11]] (e.g. a different Bearer Token), then the <a>WoT Consumer</a> MUST NOT re-use the
        connection.</p>
    </section>
  </section>

  <section id="websocket-messages">
    <h2>WebSocket Messages</h2>
    <p>All messages MUST be a JSON <a href="https://www.rfc-editor.org/rfc/rfc8259#section-4">object</a> [[JSON]].</p>

    <table class="def">
      <caption>Common members of all messages</caption>
      <thead>
        <tr>
          <th>Member</th>
          <th>Type</th>
          <th>Assignment</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><code>thingID</code></td>
          <td>string</td>
          <td>Mandatory</td>
          <td>The ID (URI) of the <a>Thing</a> to which the message relates.</td>
        </tr>
        <tr>
          <td><code>messageID</code></td>
          <td>string</td>
          <td>Mandatory</td>
          <td>A unique identifier (UUID) for the current message.</td>
        </tr>
        <tr>
          <td><code>messageType</code></td>
          <td>string</td>
          <td>Mandatory</td>
          <td>A string which denotes the type of message (one of <code>request</code>, <code>response</code> or
            <code>notification</code>).
          </td>
        </tr>
        <tr>
          <td><code>operation</code></td>
          <td>string</td>
          <td>Mandatory</td>
          <td>A string which denotes the type of <a
              href="https://www.w3.org/TR/wot-thing-description/#td-vocab-op--Form">WoT operation</a>
            [[wot-thing-description11]] to which the message relates (one of
            <code>readproperty</code>, <code>writeproperty</code>, <code>observeproperty</code>,
            <code>unobserveproperty</code>, <code>invokeaction</code>, <code>queryaction</code>,
            <code>cancelaction</code>, <code>subscribeevent</code>, <code>unsubscribeevent</code>,
            <code>readallproperties</code>, <code>writeallproperties</code>, <code>readmultipleproperties</code>,
            <code>writemultipleproperties</code>, <code>observeallproperties</code>,
            <code>unobserveallproperties</code>, <code>subscribeallevents</code>, <code>unsubscribeallevents</code>, or
            <code>queryallactions</code>).
        </tr>
        <tr>
          <td><code>correlationID</code></td>
          <td>string</td>
          <td>Optional</td>
          <td>A unique identifer (UUID) which is shared between messages corresponding to the same operation, e.g. a
            request and a response.</td>
        </tr>
      </tbody>
    </table>

    <p>The top level JSON object MUST contain a <code>thingID</code> member with the value set to a unique identifier of
      the <a>Web Thing</a> to which the message relates.
      If the <a>Thing Description</a> of the <a>Web Thing</a> contains an <code>id</code> member then the value of that
      <code>id</code> member MUST be used as the unique identifier assigned to <code>thingID</code>.
      If the <a>Thing Description</a> of the <a>Web Thing</a> does not contain an <code>id</code> member then the URL
      [[URL]] from which the <a>Thing Description</a> was retrieved MAY be used as the <code>thingID</code> value
      instead. The value of the <code>thingID</code> member MUST be a valid URI [[URI]] serialised as a string.
    </p>
    <p>The top level JSON object MUST contain a <code>messageID</code> member with the value set to a unique identifier
      for the current message in UUIDv4 format [[rfc9562]].</p>
    <p>The top level JSON object MUST contain a <code>messageType</code> member, with its value set to one of
      <code>request</code>, <code>response</code> or <code>notification</code>.
    </p>


    <table id="message-types-table" class="def">
      <caption>Message types</caption>
      <thead>
        <tr>
          <th>Message type</th>
          <th>Direction</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><code>request</code></td>
          <td>Consumer ➡ Thing</td>
          <td>A message sent from a Consumer to a Thing (e.g. to request a reading of a property, invoke an
            action or subscribe to an event)</td>
        </tr>
        <tr>
          <td><code>response</code></a></td>
          <td>Thing ➡ Consumer</td>
          <td>A message sent from a Thing to a Consumer in response to a request (e.g. to respond with a property
            reading, provide the final response to an action or confirm a subscription to an event)</td>
        </tr>
        <tr>
          <td><code>notification</code></td>
          <td>Thing ➡ Consumer</td>
          <td>A message pushed from a Thing to a Consumer (e.g. an event, change in property value, or
            change in action state)</td>
        </tr>
      </tbody>
    </table>

    <p>The top level JSON object MUST contain an <code>operation</code> member, with its value set to one of the
      well-known <a href="https://www.w3.org/TR/wot-thing-description/#td-vocab-op--Form">WoT operation</a> names from
      the Thing Description specification [[wot-thing-description11]].</p>
    <p>The lifecycle of an operation consists of a series of messages in a sequence (e.g. a request followed by a
      response, or a request followed by a response then one or more notifications). Each type of operation follows a
      particular sequence of message types, outlined in the table below:</p>

    <table id="operation-lifecycles" class="def">
      <caption>Operation lifecycles</caption>
      <thead>
        <tr>
          <th>Operation</th>
          <th>Lifecycle</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><a href="#readproperty"><code>readproperty</code></a></td>
          <td><a href="#readproperty-request">request</a>, <a href="#readproperty-response">response</a></td>
        </tr>
        <tr>
          <td><a href="#writeproperty"><code>writeproperty</code></a></td>
          <td><a href="#writeproperty-request">request</a>, <a href="#writeproperty-response">response</a></td>
        </tr>
        <tr>
          <td><a href="#readallproperties"><code>readallproperties</code></a></td>
          <td><a href="#readallproperties-request">request</a>, <a href="#readallproperties-response">response</a></td>
        </tr>
        <tr>
          <td><a href="#readmultipleproperties"><code>readmultipleproperties</code></a></td>
          <td><a href="#readmultipleproperties-request">request</a>, <a
              href="#readmultipleproperties-response">response</a></td>
        </tr>
        <tr>
          <td><a href="#writeallproperties"><code>writeallproperties</code></a></td>
          <td><a href="#writeallproperties-request">request</a>,
            <a href="#writeallproperties-response">response</a>
          </td>
        </tr>
        <tr>
          <td><a href="#writemultipleproperties"><code>writemultipleproperties</code></a></td>
          <td><a href="#writemultipleproperties-request">request</a>,
            <a href="#writemultipleproperties-response">response</a>
          </td>
        </tr>
        <tr>
          <td><a href="#observeproperty"><code>observeproperty</code></a></td>
          <td><a href="#observeproperty-request">request</a>,
            <a href="#observeproperty-response">response</a>,
            <a href="#observeproperty-notification">notification</a>,
            <a href="#observeproperty-notification">notification</a>...
          </td>
        </tr>
        <tr>
          <td><a href="#unobserveproperty"><code>unobserveproperty</code></a></td>
          <td><a href="#unobserveproperty-request">request</a>, <a href="#unobserveproperty-response">response</a></td>
        </tr>
        <tr>
          <td><a href="#observeallproperties"><code>observeallproperties</code></a></td>
          <td><a href="#observeallproperties-request">request</a>,
            <a href="#observeallproperties-response">response</a>,
            <a href="#observeallproperties-notification">notification</a>,
            <a href="#observeallproperties-notification">notification</a>...
          </td>
        </tr>
        <tr>
          <td><a href="#unobserveallproperties"><code>unobserveallproperties</code></a></td>
          <td><a href="#unobserveallproperties-request">request</a>,
            <a href="#unobserveallproperties-response">response</a>
          </td>
        </tr>
        <tr>
          <td><a href="#invokeaction"><code>invokeaction</code></a></td>
          <td><a href="#invokeaction-request">request</a>, <a href="#invokeaction-notification">notification</a>,
            <a href="#invokeaction-notification">notification</a>... <a href="#invokeaction-response">response</a>
          </td>
        </tr>
      </tbody>
    </table>

    <p>The top level JSON object MAY contain a <code>correlationID</code> member which provides a unique identifier in
      UUIDv4 format [[rfc9562]] which is shared between messages corresponding to the same WoT operation (e.g. a
      property read request and response, or an event subscription request and event notification). If a request message
      contains a <code>correlatonID</code> member then any response and notification messages which correspond to the
      same operation MUST also include a <code>correlationID</code> member with the same value.</p>

    <p>All date and time values MUST use the <code>date-time</code> format
      defined in [[RFC3339]].</span>
    </p>
    <pre class="example" title="Example timestamp">
      <code>2025-01-15T12:08:00.42Z</code>
    </pre>
    <p class="note">
      In order to reduce ambiguity, RFC 3339 only permits an hour with a value
      between 00 and 23 (not 24), and time zones expressed as a numerical
      offset relative to UTC. The suffix "Z" when applied to a time denotes a
      UTC offset of 00:00.
    </p>

    <section id="readproperty">
      <h3><code>readproperty</code></h3>
      <section id="readproperty-request">
        <h4>Request</h4>
        <p>To request a property reading from a <a>Thing</a>, a <a>Consumer</a> MUST send a <a
            href="#websocket-messages">message</a> to the <a>Thing</a>
          which contains the following members:</p>
        <table class="def">
          <caption>Members of a <code>readproperty</code> request message</caption>
          <thead>
            <tr>
              <th>Member</th>
              <th>Type</th>
              <th>Assignment</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>messageType</code></td>
              <td>string</td>
              <td>"request"</td>
              <td>A string which denotes that this message is a request sent from a Consumer to a Thing.</td>
            </tr>
            <tr>
              <td><code>operation</code></td>
              <td>string</td>
              <td>"readproperty"</td>
              <td>A string which denotes that this message relates to a <code>readproperty</code> operation.</td>
            </tr>
            <tr>
              <td><code>name</code></td>
              <td>string</td>
              <td>Mandatory</td>
              <td>The name of the <a>Property</a> to read, as per its key in the <code>properties</code> member of
                the <a>Thing Description</a>.
              </td>
            </tr>
          </tbody>
        </table>
        <pre class="example" title="readproperty request message">
          {
            "thingID": "https://mythingserver.com/things/mylamp1",
            "messageID": "c370da58-69ae-4e83-bb5a-ac6cfb2fed54",
            "messageType": "request",
            "operation": "readproperty",
            "name": "on",
            "correlationID": "5afb752f-8be0-4a3c-8108-1327a6009cbd"
          }
        </pre>
        <p>When a <a>Thing</a> receives a message from a <a>Consumer</a> with <code>messageType</code> set to
          <code>request</code> and <code>operation</code> set to <code>readproperty</code> it MUST
          attempt to read the value of the <a>Property</a> with the given <code>name</code>.
        </p>
      </section>
      <section id="readproperty-response">
        <h4>Response</h4>
        <p>Upon successfully reading the value of the requested <a>Property</a>, the Thing MUST send a message to the
          requesting <code>Consumer</code> containing the following members:</p>
        <table class="def">
          <caption>Members of a <code>readproperty</code> response message</caption>
          <thead>
            <tr>
              <th>Member</th>
              <th>Type</th>
              <th>Assignment</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>messageType</code></td>
              <td>string</td>
              <td>"response"</td>
              <td>A string which denotes that this message is a response sent from a <a>Thing</a> to a <a>Consumer</a>.
              </td>
            </tr>
            <tr>
              <td><code>operation</code></td>
              <td>string</td>
              <td>"readproperty"</td>
              <td>A string which denotes that this message relates to a <code>readproperty</code> operation.
              </td>
            </tr>
            <tr>
              <td><code>name</code></td>
              <td>string</td>
              <td>Mandatory</td>
              <td>The name of the <a>Property</a> being read, as per its key in the <code>properties</code> member of
                the
                <a>Thing Description</a>.
              </td>
            </tr>
            <tr>
              <td><code>value</code></td>
              <td>any</td>
              <td>Mandatory</td>
              <td>The current value of the <a>Property</a> being read, with a type and structure conforming to the data
                schema of the corresponding PropertyAffordance in the <a>Thing Description</a>.</td>
            </tr>
            <tr>
              <td><code>timestamp</code></td>
              <td>string</td>
              <td>Optional</td>
              <td>A timestamp in date-time format [[RFC3339]] set to the time the property reading took place.</td>
            </tr>
          </tbody>
        </table>
        <pre class="example" title="readproperty response message">
          {
            "thingID": "https://mythingserver.com/things/mylamp1",
            "messageID": "79057736-3e0e-4dc3-b139-a33051901ee2",
            "messageType": "response",
            "operation": "readproperty",
            "name": "on",
            "value": true,
            "timestamp": "2024-01-13T23:20:50.52Z",
            "correlationID": "5afb752f-8be0-4a3c-8108-1327a6009cbd"
          }
        </pre>
      </section>
    </section>

    <section id="writeproperty">
      <h3><code>writeproperty</code></h3>
      <section id="writeproperty-request">
        <h4>Request</h4>
        <p>To set the value of a <a>Property</a> of a <a>Thing</a>, a <a>Consumer</a> MUST send a <a
            href="#websocket-messages">message</a> to the <a>Thing</a> which contains the following members:</p>
        <table class="def">
          <caption>Members of a <code>writeproperty</code> request message</caption>
          <thead>
            <tr>
              <th>Member</th>
              <th>Type</th>
              <th>Assignment</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>messageType</code></td>
              <td>string</td>
              <td>"request"</td>
              <td>A string which denotes that this message is a request sent from a Consumer to a Thing.</td>
            </tr>
            <tr>
              <td><code>operation</code></td>
              <td>string</td>
              <td>"writeproperty"</td>
              <td>A string which denotes that this message relates to a <code>writeproperty</code> operation.</td>
            </tr>
            <tr>
              <td><code>name</code></td>
              <td>string</td>
              <td>Mandatory</td>
              <td>The name of the <a>Property</a> whose value should be set, as per its key in the
                <code>properties</code> member of the <a>Thing Description</a>.
              </td>
            </tr>
            <tr>
              <td><code>value</code></td>
              <td>any</td>
              <td>Mandatory</td>
              <td>The desired new value of the <a>Property</a>, with a type and structure conforming to the data schema
                of the corresponding PropertyAffordance in the <a>Thing Description</a>.</td>
            </tr>
          </tbody>
        </table>
        <pre class="example" title="writeproperty request message">
          {
            "thingID": "https://mythingserver.com/things/mylamp1",
            "messageID": "97d22676-6d45-4435-aef5-dd87467a0c44",
            "messageType": "response",
            "operation": "writeproperty",
            "name": "on",
            "value": true,
            "correlationID": "f6cf46a8-9c96-437e-8b53-925b7679a990"
          }
        </pre>
      </section>

      <section id="writeproperty-response">
        <h4>Response</h4>
        <p>When a <a>Thing</a> receives a message from a <a>Consumer</a> with <code>messageType</code> set to
          <code>request</code> and <code>operation</code> set to <code>writeproperty</code> it MUST
          attempt to set the <a>Property</a> with the name provided in the <code>name</code> member to
          the value provided in the <code>value</code> member.
        </p>
        <p>Upon successfully submitting the value of the requested <a>Property</a>, the Thing MUST send a message to the
          requesting <code>Consumer</code> containing the following members:</p>
        <table class="def">
          <caption>Members of a <code>writeproperty</code> response message</caption>
          <thead>
            <tr>
              <th>Member</th>
              <th>Type</th>
              <th>Assignment</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>messageType</code></td>
              <td>string</td>
              <td>"response"</td>
              <td>A string which denotes that this message is a response sent from a <a>Thing</a> to a <a>Consumer</a>.
              </td>
            </tr>
            <tr>
              <td><code>operation</code></td>
              <td>string</td>
              <td>"writeproperty"</td>
              <td>A string which denotes that this message relates to a <code>writeproperty</code> operation.
              </td>
            </tr>
            <tr>
              <td><code>name</code></td>
              <td>string</td>
              <td>Mandatory</td>
              <td>The name of the <a>Property</a> being written, as per its key in the <code>properties</code> member of
                the
                <a>Thing Description</a>.
              </td>
            </tr>
            <tr>
              <td><code>value</code></td>
              <td>any</td>
              <td>Optional</td>
              <td>The value which has been successfully assigned to the <a>Property</a> being written, with a type and
                structure conforming to the data schema of the corresponding PropertyAffordance in the <a>Thing
                  Description</a>.
              </td>
            </tr>
            <tr>
              <td><code>timestamp</code></td>
              <td>string</td>
              <td>Optional</td>
              <td>A timestamp in date-time format [[RFC3339]] set to the time the property write took place.</td>
            </tr>
          </tbody>
        </table>
        <pre class="example" title="writeproperty response message">
          {
            "thingID": "https://mythingserver.com/things/mylamp1",
            "messageID": "db25fe4f-bee8-43a7-8ff0-3a1ff6e620b0",
            "messageType": "response",
            "operation": "writeproperty",
            "name": "on",
            "value": true,
            "timestamp": "2024-01-13T23:20:50.52Z",
            "correlationID": "f6cf46a8-9c96-437e-8b53-925b7679a990"
          }
        </pre>
        <p>If the <a>Thing</a> can confirm that the requested value has been set successfully then the response message
          to a <code>writeproperty</code> request SHOULD contain a <code>value</code> member with its value set to the
          value which has been successfully set.
        </p>
        <p>If the <a>Thing</a> can not confirm that the requested value has been set successfully (e.g. in the case of a
          write-only property or a device that is temporarily asleep so the write has been queued) then
          the response message to a <code>writeproperty</code> request MUST NOT contain a
          <code>value</code> member.
        </p>
        <p>If a Consumer attempts to set the value of a numerical <a>Property</a> to a value which conforms to the
          <a>Property</a>'s data schema but to a level of precision the Thing does not support, (e.g. 3.14159), then the
          <a>Thing</a> MAY respond with the actual value set (e.g. 3.14).
        </p>
        </p>
      </section>
    </section>

    <section id="readallproperties">
      <h3><code>readallproperties</code></h3>
      <section id="readallproperties-request">
        <h4>Request</h4>
        <p>To request a reading of all of a <a>Thing</a>'s readable <a>Properties</a> at once, a <a>Consumer</a> MUST
          send a <a href="#websocket-messages">message</a> to the <a>Thing</a>
          which contains the following members:</p>
        <table class="def">
          <caption>Members of a <code>readallproperties</code> request message</caption>
          <thead>
            <tr>
              <th>Member</th>
              <th>Type</th>
              <th>Assignment</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>messageType</code></td>
              <td>string</td>
              <td>"request"</td>
              <td>A string which denotes that this message is a request sent from a Consumer to a Thing.</td>
            </tr>
            <tr>
              <td><code>operation</code></td>
              <td>string</td>
              <td>"readallproperties"</td>
              <td>A string which denotes that this message relates to a <code>readallproperties</code> operation.</td>
            </tr>
          </tbody>
        </table>
        <pre class="example" title="readallproperties request message">
          {
            "thingID": "https://mythingserver.com/things/mylamp1",
            "messageID": "e144349c-5cd7-4002-938f-aac5adf99789",
            "messageType": "request",
            "operation": "readallproperties",
            "correlationID": "c08075a4-d53c-4f51-b251-a6b6922c2b1f"
          }
        </pre>
        <p>When a <a>Thing</a> receives a message from a <a>Consumer</a> with <code>messageType</code> set to
          <code>request</code> and <code>operation</code> set to <code>readallproperties</code> it MUST
          attempt to read the value of all of its readable <a>Properties</a> (i.e. all
          <a href="https://www.w3.org/TR/wot-thing-description/#propertyaffordance">Property Affordances</a> where
          <a
            href="https://www.w3.org/TR/wot-thing-description/#td-vocab-writeOnly--DataSchema"><code>writeOnly</code></a>
          [[wot-thing-description11]] is not set to <code>true</code>).
        </p>
      </section>
      <section id="readallproperties-response">
        <h4>Response</h4>
        <p>Upon successfully reading the value of all of its readable <a>Properties</a>, the Thing MUST send a message
          to the requesting <a>Consumer</a> containing the following members:</p>
        <table class="def">
          <caption>Members of a <code>readallproperties</code> response message</caption>
          <thead>
            <tr>
              <th>Member</th>
              <th>Type</th>
              <th>Assignment</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>messageType</code></td>
              <td>string</td>
              <td>"response"</td>
              <td>A string which denotes that this message is a response sent from a <a>Thing</a> to a <a>Consumer</a>.
              </td>
            </tr>
            <tr>
              <td><code>operation</code></td>
              <td>string</td>
              <td>"readallproperties"</td>
              <td>A string which denotes that this message relates to a <code>readallproperties</code> operation.
              </td>
            </tr>
            <tr>
              <td><code>values</code></td>
              <td>object</td>
              <td>Mandatory</td>
              <td>The values of all <a>Properties</a> contained in an object keyed by <a>Property</a> name, with the
                value of each <a>Property</a> conforming to the data schema of the corresponding PropertyAffordance in
                the <a>Thing Description</a>.</td>
            </tr>
            <tr>
              <td><code>timestamp</code></td>
              <td>string</td>
              <td>Optional</td>
              <td>A timestamp in date-time format [[RFC3339]] set to the time the property readings took place.</td>
            </tr>
          </tbody>
        </table>
        <pre class="example" title="readallproperties response message">
          {
            "thingID": "https://mythingserver.com/things/mylamp1",
            "messageID": "79057736-3e0e-4dc3-b139-a33051901ee2",
            "messageType": "response",
            "operation": "readallproperties",
            "values": {
              "on": true,
              "level": 50
            },
            "timestamp": "2025-05-22T17:15:35.636Z",
            "correlationID": "c08075a4-d53c-4f51-b251-a6b6922c2b1f"
          }
        </pre>
      </section>
      <section id="readallproperties-error-response">
        <h4>Error Response</h4>
        <p>If a <a>Thing</a> receives a <code>readallproperties</code> request message from a <a>Consumer</a>
          but the reading of at least one of the properties unexpectedly fails, then it MUST send an
          <a href="#error-response">error response</a> to the <a>Consumer</a> with <code>status</code> set to
          <code>500</code>.
        </p>
        <pre class="example" title="Example readallproperties Internal Server Error error response message">
          <code>
            {
              "thingID": "https://mythingserver.com/things/mylamp1",
              "messageID": "1876e481-5fc2-4b39-93b4-1f434f7b6a47",
              "messageType": "response",
              "operation": "readallproperties",
              "error": {
                "status": "500",
                "type": "https://w3c.github.io/web-thing-protocol/errors#500",
                "title": "Internal Server Error"
                "detail": "Reading the 'level' property unexpectedly failed"
              }
              "timestamp": "2025-05-22T17:15:36.636Z",
              "correlationID": "c08075a4-d53c-4f51-b251-a6b6922c2b1f"
            }
          </code>
        </pre>
        <p>If a <code>readallproperties</code> operation only partially fails (i.e. some <a>Properties</a> can be
          read but others can not), a <a>Thing</a> MAY include the successfully read values in the error
          response, in a <code>values</code> member keyed by <a>Property</a> name.
        </p>
      </section>
    </section>

    <section id="readmultipleproperties">
      <h3><code>readmultipleproperties</code></h3>
      <section id="readmultipleproperties-request">
        <h4>Request</h4>
        <p>To request a reading of multiple readable <a>Properties</a> of a <a>Thing</a> at once, a <a>Consumer</a> MUST
          send a
          <a href="#websocket-messages">message</a> to the <a>Thing</a> which contains the following members:
        </p>
        <table class="def">
          <caption>Members of a <code>readmultipleproperties</code> request message</caption>
          <thead>
            <tr>
              <th>Member</th>
              <th>Type</th>
              <th>Assignment</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>messageType</code></td>
              <td>string</td>
              <td>"request"</td>
              <td>A string which denotes that this message is a request sent from a Consumer to a Thing.</td>
            </tr>
            <tr>
              <td><code>operation</code></td>
              <td>string</td>
              <td>"readmultipleproperties"</td>
              <td>A string which denotes that this message relates to a <code>readmultipleproperties</code> operation.
              </td>
            </tr>
            <tr>
              <td><code>names</code></td>
              <td>array</td>
              <td>Mandatory</td>
              <td>An array of strings specifying the names of the <a>Properties</a> to read, as per their keys in the
                <code>properties</code> member of the <a>Thing Description</a>.
            </tr>
          </tbody>
        </table>
        <pre class="example" title="readmultipleproperties request message">
          {
            "thingID": "https://mythingserver.com/things/mylamp1",
            "messageID": "dacaea0e-43c2-4fc0-bd66-5a807ca52324",
            "messageType": "request",
            "operation": "readmultipleproperties",
            "names": ["on", "level"],
            "correlationID": "c0503f71-288f-4460-b308-c4cc0009cd89"
          }
        </pre>
        <p>When a <a>Thing</a> receives a message from a <a>Consumer</a> with <code>messageType</code> set to
          <code>request</code> and <code>operation</code> set to <code>readmultipleproperties</code> it MUST
          attempt to read the value of all the <a>Properties</a> specified in the <code>names</code> member of the
          message.
        </p>
      </section>
      <section id="readmultipleproperties-response">
        <h4>Response</h4>
        <p>Upon successfully reading the values of the specified <a>Properties</a>, the Thing MUST send a message to the
          requesting <a>Consumer</a> containing the following members:</p>
        <table class="def">
          <caption>Members of a <code>readmultipleproperties</code> response message</caption>
          <thead>
            <tr>
              <th>Member</th>
              <th>Type</th>
              <th>Assignment</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>messageType</code></td>
              <td>string</td>
              <td>"response"</td>
              <td>A string which denotes that this message is a response sent from a <a>Thing</a> to a <a>Consumer</a>.
              </td>
            </tr>
            <tr>
              <td><code>operation</code></td>
              <td>string</td>
              <td>"readmultipleproperties"</td>
              <td>A string which denotes that this message relates to a <code>readmultipleproperties</code> operation.
              </td>
            </tr>
            <tr>
              <td><code>values</code></td>
              <td>object</td>
              <td>Mandatory</td>
              <td>The values of the read <a>Properties</a> contained in an object keyed by <a>Property</a> name, with
                the value of each <a>Property</a> conforming to the data schema of the corresponding PropertyAffordance
                in the <a>Thing Description</a>.</td>
            </tr>
            <tr>
              <td><code>timestamp</code></td>
              <td>string</td>
              <td>Optional</td>
              <td>A timestamp in date-time format [[RFC3339]] set to the time the property readings took place.</td>
            </tr>
          </tbody>
        </table>
        <pre class="example" title="readmultipleproperties response message">
          {
            "thingID": "https://mythingserver.com/things/mylamp1",
            "messageID": "695a2626-be5f-4f91-8719-105abc52aa0f",
            "messageType": "response",
            "operation": "readmultipleproperties",
            "values": {
              "on": true,
              "level": 50
            },
            "timestamp": "2025-05-22T18:04:33.531Z",
            "correlationID": "c0503f71-288f-4460-b308-c4cc0009cd89"
          }
        </pre>
      </section>
      <section id="readmultipleproperties-error-response">
        <h4>Error Response</h4>
        <p>If a <a>Thing</a> receives a <code>readmultipleproperties</code> request message from a <a>Consumer</a> with
          a
          <code>names</code> member which is empty, contains an invalid <a>Property</a> name, or the name of a
          <a
            href="https://www.w3.org/TR/wot-thing-description/#td-vocab-writeOnly--DataSchema"><code>writeOnly</code></a>
          [[wot-thing-description11]] <a>Property</a>, then it MUST send an <a href="#error-response">error response</a>
          to
          the <a>Consumer</a> with <code>status</code> set to <code>400</code>.
        </p>
        <pre class="example" title="Example readmultipleproperties Bad Request error response message">
          <code>
            {
              "thingID": "https://mythingserver.com/things/mylamp1",
              "messageID": "72e6f397-8ae9-4882-ac7d-303a953527a5",
              "messageType": "response",
              "operation": "readmultipleproperties",
              "error": {
                "status": "400",
                "type": "https://w3c.github.io/web-thing-protocol/errors#400",
                "title": "Bad Request"
                "detail": "No property found with the name 'volume'"
              }
              "timestamp": "2025-05-22T18:04:33.531Z",
              "correlationID": "c0503f71-288f-4460-b308-c4cc0009cd89"
            }
          </code>
        </pre>
        <p>If a <a>Thing</a> receives a <code>readmultipleproperties</code> request message from a <a>Consumer</a> with
          a
          <code>names</code> member containing valid <a>Property</a> names but the reading of at least one of the
          properties
          unexpectedly fails, then it MUST send an <a href="#error-response">error response</a> to
          the <a>Consumer</a> with <code>status</code> set to <code>500</code>.
        </p>
        <pre class="example" title="Example readmultipleproperties Internal Server Error error response message">
          <code>
            {
              "thingID": "https://mythingserver.com/things/mylamp1",
              "messageID": "cf0240ca-e21c-49b8-bca4-e27002525ea1",
              "messageType": "response",
              "operation": "readmultipleproperties",
              "error": {
                "status": "500",
                "type": "https://w3c.github.io/web-thing-protocol/errors#500",
                "title": "Internal Server Error"
                "detail": "Reading the 'level' property unexpectedly failed"
              }
              "timestamp": "2025-05-22T18:04:33.531Z",
              "correlationID": "c0503f71-288f-4460-b308-c4cc0009cd89"
            }
          </code>
        </pre>
        <p>If a <code>readmultipleproperties</code> operation only partially fails (i.e. some <a>Properties</a> can be
          read but others can not), a <a>Thing</a> MAY include the successfully read values in the error
          response, in a <code>values</code> member keyed by <a>Property</a> name.
        </p>
      </section>
    </section>

    <section id="writeallproperties">
      <h3><code>writeallproperties</code></h3>
      <section id="writeallproperties-request">
        <h4>Request</h4>
        <p>To set the value of all <a>Properties</a> of a <a>Thing</a> at once, a <a>Consumer</a> MUST
          send a
          <a href="#websocket-messages">message</a> to the <a>Thing</a> which contains the following members:
        </p>
        <table class="def">
          <caption>Members of a <code>writeallproperties</code> request message</caption>
          <thead>
            <tr>
              <th>Member</th>
              <th>Type</th>
              <th>Assignment</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>messageType</code></td>
              <td>string</td>
              <td>"request"</td>
              <td>A string which denotes that this message is a request sent from a Consumer to a Thing.</td>
            </tr>
            <tr>
              <td><code>operation</code></td>
              <td>string</td>
              <td>"writeallproperties"</td>
              <td>A string which denotes that this message relates to a <code>writeallproperties</code> operation.
              </td>
            </tr>
            <tr>
              <td><code>values</code></td>
              <td>object</td>
              <td>Mandatory</td>
              <td>An object keyed by <a>Property</a> name, containing the desired value of each <a>Property</a>, with a
                type and structure conforming to the data schema of each corresponding PropertyAffordance in the
                <a>Thing Description</a>.
              </td>
            </tr>
          </tbody>
        </table>
        <pre class="example" title="writeallproperties request message">
          {
            "thingID": "https://mythingserver.com/things/mylamp1",
            "messageID": "60c33fc4-ed99-446e-a2e3-f3b5be82c34b",
            "messageType": "request",
            "operation": "writeallproperties",
            "values": {
              "on": true,
              "level": 75
            },
            "correlationID": "551aaa52-ff95-4fb5-a657-2b5f430d47ff"
          }
        </pre>
        <p>When a <a>Thing</a> receives a message from a <a>Consumer</a> with <code>messageType</code> set to
          <code>request</code> and <code>operation</code> set to <code>writeallproperties</code> it MUST
          attempt to write the values of all writeable <a>Properties</a> using the values specified in the
          <code>values</code> member of the message.
        </p>
      </section>
      <section id="writeallproperties-response">
        <h4>Response</h4>
        <p>Upon successfully writing the values of all writeable <a>Properties</a>, the Thing MUST send a message to the
          requesting <a>Consumer</a> containing the following members:</p>
        <table class="def">
          <caption>Members of a <code>writeallproperties</code> response message</caption>
          <thead>
            <tr>
              <th>Member</th>
              <th>Type</th>
              <th>Assignment</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>messageType</code></td>
              <td>string</td>
              <td>"response"</td>
              <td>A string which denotes that this message is a response sent from a <a>Thing</a> to a <a>Consumer</a>.
              </td>
            </tr>
            <tr>
              <td><code>operation</code></td>
              <td>string</td>
              <td>"writeallproperties"</td>
              <td>A string which denotes that this message relates to a <code>writeallproperties</code> operation.
              </td>
            </tr>
            <tr>
              <td><code>values</code></td>
              <td>object</td>
              <td>Mandatory</td>
              <td>An object keyed by <a>Property</a> name, containing the values which have been successfully assigned
                to writeable <a>Properties</a>, with the type and structure of each value conforming to the data schema
                in its corresponding PropertyAffordance in the <a>Thing Description</a>.
              </td>
            </tr>
            <tr>
              <td><code>timestamp</code></td>
              <td>string</td>
              <td>Optional</td>
              <td>A timestamp in date-time format [[RFC3339]] set to the time the property readings took place.</td>
            </tr>
          </tbody>
        </table>
        <pre class="example" title="writeallproperties response message">
          {
            "thingID": "https://mythingserver.com/things/mylamp1",
            "messageID": "74022347-72c2-4fa1-9e34-1a662bdff85e",
            "messageType": "response",
            "operation": "writeallproperties",
            "values": {
              "on": true,
              "level": 75
            },
            "timestamp": "2025-08-13T17:11:00.531Z",
            "correlationID": "551aaa52-ff95-4fb5-a657-2b5f430d47ff"
          }
        </pre>
      </section>
      <section id="writeallproperties-error-response">
        <h4>Error Response</h4>
        <p>If a <a>Thing</a> receives a <code>writeallproperties</code> request message from a <a>Consumer</a> which
          does not contain values for all writeable properties, contains an invalid <a>Property</a> name, contains the
          name
          of a <a
            href="https://www.w3.org/TR/wot-thing-description/#td-vocab-readOnly--DataSchema"><code>readOnly</code></a>
          [[wot-thing-description11]] <a>Property</a>, or contains a value which does not conform to the data schema of
          the
          corresponding PropertyAffordance then it MUST send an <a href="#error-response">error response</a>
          to the <a>Consumer</a> with <code>status</code> set to <code>400</code>.
        </p>
        <pre class="example" title="Example writeallproperties Bad Request error response message">
          <code>
            {
              "thingID": "https://mythingserver.com/things/mylamp1",
              "messageID": "6dcfce6a-b0cd-48e7-992a-b96d5cb2b872",
              "messageType": "response",
              "operation": "writeallproperties",
              "error": {
                "status": "400",
                "type": "https://w3c.github.io/web-thing-protocol/errors#400",
                "title": "Bad Request"
                "detail": "No property found with the name 'volume'"
              }
              "timestamp": "2025-08-13T18:31:43.531Z",
              "correlationID": "551aaa52-ff95-4fb5-a657-2b5f430d47ff"
            }
          </code>
        </pre>
        <p>If a <a>Thing</a> receives a <code>writeallproperties</code> request message from a <a>Consumer</a> with
          a <code>values</code> member containing valid names and values for all writeable <a>Properties</a>, but the
          writing of at least one of the properties unexpectedly fails, then it MUST send an
          <a href="#error-response">error response</a> to the <a>Consumer</a> with <code>status</code> set to
          <code>500</code>.
        </p>
        <pre class="example" title="Example writeallproperties Internal Server Error error response message">
          <code>
            {
              "thingID": "https://mythingserver.com/things/mylamp1",
              "messageID": "35caf0d3-05f6-4a15-8ddf-a765b5280b06",
              "messageType": "response",
              "operation": "writeallproperties",
              "error": {
                "status": "500",
                "type": "https://w3c.github.io/web-thing-protocol/errors#500",
                "title": "Internal Server Error"
                "detail": "Writing the 'level' property unexpectedly failed"
              }
              "timestamp": "2025-08-13T19:04:36.426Z",
              "correlationID": "551aaa52-ff95-4fb5-a657-2b5f430d47ff"
            }
          </code>
        </pre>
        <p>If a <code>writeallproperties</code> operation only partially fails (i.e. some <a>Properties</a> are
          written successfully but others are not), a <a>Thing</a> MUST include the successfully written values
          in the error response, in a <code>values</code> member keyed by <a>Property</a> name.
        </p>
      </section>
    </section>

    <section id="writemultipleproperties">
      <h3><code>writemultipleproperties</code></h3>
      <section id="writemultipleproperties-request">
        <h4>Request</h4>
        <p>To set the value of multiple <a>Properties</a> of a <a>Thing</a> at once, a <a>Consumer</a> MUST
          send a
          <a href="#websocket-messages">message</a> to the <a>Thing</a> which contains the following members:
        </p>
        <table class="def">
          <caption>Members of a <code>writemultipleproperties</code> request message</caption>
          <thead>
            <tr>
              <th>Member</th>
              <th>Type</th>
              <th>Assignment</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>messageType</code></td>
              <td>string</td>
              <td>"request"</td>
              <td>A string which denotes that this message is a request sent from a Consumer to a Thing.</td>
            </tr>
            <tr>
              <td><code>operation</code></td>
              <td>string</td>
              <td>"writemultipleproperties"</td>
              <td>A string which denotes that this message relates to a <code>writemultipleproperties</code> operation.
              </td>
            </tr>
            <tr>
              <td><code>values</code></td>
              <td>object</td>
              <td>Mandatory</td>
              <td>An object keyed by <a>Property</a> name, containing the desired value of each <a>Property</a>, with a
                type and structure conforming to the data schema of each corresponding PropertyAffordance in the
                <a>Thing Description</a>.
              </td>
            </tr>
          </tbody>
        </table>
        <pre class="example" title="writemultipleproperties request message">
          {
            "thingID": "https://mythingserver.com/things/mylamp1",
            "messageID": "02c576a2-5adf-4924-b2c8-2222396a3d5c",
            "messageType": "request",
            "operation": "writemultipleproperties",
            "values": {
              "on": false,
              "level": 25
            },
            "correlationID": "e851583f-e152-4cad-9bb3-7bd3b24f8525"
          }
        </pre>
        <p>When a <a>Thing</a> receives a message from a <a>Consumer</a> with <code>messageType</code> set to
          <code>request</code> and <code>operation</code> set to <code>writemultipleproperties</code> it MUST
          attempt to write the values of the <a>Properties</a> specified in the <code>values</code> member of
          the message.
        </p>
      </section>
      <section id="writemultipleproperties-response">
        <h4>Response</h4>
        <p>Upon successfully writing the values of the specified <a>Properties</a>, the Thing MUST send a message to the
          requesting <a>Consumer</a> containing the following members:</p>
        <table class="def">
          <caption>Members of a <code>writemultipleproperties</code> response message</caption>
          <thead>
            <tr>
              <th>Member</th>
              <th>Type</th>
              <th>Assignment</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>messageType</code></td>
              <td>string</td>
              <td>"response"</td>
              <td>A string which denotes that this message is a response sent from a <a>Thing</a> to a <a>Consumer</a>.
              </td>
            </tr>
            <tr>
              <td><code>operation</code></td>
              <td>string</td>
              <td>"writemultipleproperties"</td>
              <td>A string which denotes that this message relates to a <code>writemultipleproperties</code> operation.
              </td>
            </tr>
            <tr>
              <td><code>values</code></td>
              <td>object</td>
              <td>Mandatory</td>
              <td>An object keyed by <a>Property</a> name, containing the values which have been successfully assigned
                to <a>Properties</a>, with the type and structure of each value conforming to the data schema
                in its corresponding PropertyAffordance in the <a>Thing Description</a>.
              </td>
            </tr>
            <tr>
              <td><code>timestamp</code></td>
              <td>string</td>
              <td>Optional</td>
              <td>A timestamp in date-time format [[RFC3339]] set to the time the property readings took place.</td>
            </tr>
          </tbody>
        </table>
        <pre class="example" title="writemultipleproperties response message">
          {
            "thingID": "https://mythingserver.com/things/mylamp1",
            "messageID": "9c5d6eaf-4624-4464-8cc0-09472443ae82",
            "messageType": "response",
            "operation": "writemultipleproperties",
            "values": {
              "on": false,
              "level": 25
            },
            "timestamp": "2025-08-17T18:35:00.246Z",
            "correlationID": "e851583f-e152-4cad-9bb3-7bd3b24f8525"
          }
        </pre>
      </section>
      <section id="writemultipleproperties-error-response">
        <h4>Error Response</h4>
        <p>If a <a>Thing</a> receives a <code>writemultipleproperties</code> request message from a <a>Consumer</a> with
          a <code>values</code> member which is empty, contains an invalid <a>Property</a> name, contains the name of a
          <a href="https://www.w3.org/TR/wot-thing-description/#td-vocab-readOnly--DataSchema"><code>readOnly</code></a>
          [[wot-thing-description11]] <a>Property</a>, or contains a value which does not conform to the data schema of
          the corresponding PropertyAffordance then it MUST send an <a href="#error-response">error response</a>
          to the <a>Consumer</a> with <code>status</code> set to <code>400</code>.
        </p>
        <pre class="example" title="Example writemultipleproperties Bad Request error response message">
          <code>
            {
              "thingID": "https://mythingserver.com/things/mylamp1",
              "messageID": "b0f9f6a3-3558-4680-8b3d-4c017c669433",
              "messageType": "response",
              "operation": "writemultipleproperties",
              "error": {
                "status": "400",
                "type": "https://w3c.github.io/web-thing-protocol/errors#400",
                "title": "Bad Request"
                "detail": "No property found with the name 'volume'"
              }
              "timestamp": "2025-08-19T18:38:35.613Z",
              "correlationID": "e851583f-e152-4cad-9bb3-7bd3b24f8525"
            }
          </code>
        </pre>
        <p>If a <a>Thing</a> receives a <code>writemultipleproperties</code> request message from a <a>Consumer</a> with
          a <code>values</code> member containing valid names and values of writeable <a>Properties</a>, but the
          writing of at least one of the properties unexpectedly fails, then it MUST send an
          <a href="#error-response">error response</a> to the <a>Consumer</a> with <code>status</code> set to
          <code>500</code>.
        </p>
        <p>If a <code>writemultipleproperties</code> operation only partially fails (i.e. some <a>Properties</a> are
          written
          successfully but others are not), a <a>Thing</a> MUST include the successfully written values in the error
          response, in a <code>values</code> member keyed by <a>Property</a> name.
        </p>
        <pre class="example" title="Example writemultipleproperties Internal Server Error error response message">
          <code>
            {
              "thingID": "https://mythingserver.com/things/mylamp1",
              "messageID": "8620b30a-03db-4332-a139-53bef96e4e47",
              "messageType": "response",
              "operation": "writemultipleproperties",
              "error": {
                "status": "500",
                "type": "https://w3c.github.io/web-thing-protocol/errors#500",
                "title": "Internal Server Error"
                "detail": "Writing the 'level' property unexpectedly failed"
              },
              "values": {
                "on": "true"
              },
              "timestamp": "2025-08-19T18:40:35.360Z",
              "correlationID": "e851583f-e152-4cad-9bb3-7bd3b24f8525"
            }
          </code>
        </pre>
      </section>
    </section>

    <section id="observeproperty">
      <h3><code>observeproperty</code></h3>
      <section id="observeproperty-request">
        <h4>Request</h4>
        <p>To observe a <a>Property</a>, a <a>Consumer</a> MUST send a <a href="#websocket-messages">message</a> to the
          <a>Thing</a> which contains the following members:
        </p>
        <table class="def">
          <caption>Members of an <code>observeproperty</code> request message</caption>
          <thead>
            <tr>
              <th>Member</th>
              <th>Type</th>
              <th>Assignment</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>messageType</code></td>
              <td>string</td>
              <td>"request"</td>
              <td>A string which denotes that this message is a request sent from a Consumer to a Thing.</td>
            </tr>
            <tr>
              <td><code>operation</code></td>
              <td>string</td>
              <td>"observeproperty"</td>
              <td>A string which denotes that this message relates to an <code>observeproperty</code> operation.</td>
            </tr>
            <tr>
              <td><code>name</code></td>
              <td>string</td>
              <td>Mandatory</td>
              <td>The name of the <a>Property</a> to be observed, as per its key in the <code>properties</code> member
                of the <a>Thing Description</a>.
              </td>
            </tr>
          </tbody>
        </table>
        <pre class="example" title="observeproperty request message">
          {
            "thingID": "https://mythingserver.com/things/mylamp1",
            "messageID": "f160098e-8c71-4025-9cb8-49fa038f5076",
            "messageType": "request",
            "operation": "observeproperty",
            "name": "level",
            "correlationID": "3b380f3c-4fb8-4dc0-8ef2-ef2c2b528931"
          }
        </pre>
        <p>When a <a>Thing</a> receives a message from a <a>Consumer</a> with <code>messageType</code> set to
          <code>request</code> and <code>operation</code> set to <code>observeproperty</code> it MUST
          attempt to register an observation subscription to the <a>Property</a> with the given <code>name</code>.
        </p>
        <p>If a <a>Thing</a> receives an <code>observeproperty</code> request for a <a>Property</a> which already has
          an active observation subscription over the same WebSocket connection, the <a>Thing</a> MUST
          replace the existing observation subscription with a new one, using the <code>correllationID</code> of the
          last <code>observeproperty</code> request received (i.e. last subscription wins).
        </p>
        <p class="note" title="Interaction between observeproperty and observeallproperties">
          If an <code>observeproperty</code> request replaces an observation subscription that was previously registered
          by an <code>observeallproperties</code> operation then that does not impact active observation subscriptions
          for other Properties, which should continue to be registered using their current <code>correllationID</code>.
          Conversely, an <code>observeallproperties</code> request may replace an observation subscription previously
          registered by an <code>observeproperty</code> operation over the same WebSocket connection, which would impact
          any active observation subscriptions for other Properties on the same connection.
        </p>
      </section>
      <section id="observeproperty-response">
        <h4>Response</h4>
        <p>Upon successfully registering an observation subscription to the requested <a>Property</a>, the Thing MUST
          send a message to the requesting <code>Consumer</code> containing the following members:</p>
        <table class="def">
          <caption>Members of an <code>observeproperty</code> response message</caption>
          <thead>
            <tr>
              <th>Member</th>
              <th>Type</th>
              <th>Assignment</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>messageType</code></td>
              <td>string</td>
              <td>"response"</td>
              <td>A string which denotes that this message is a response sent from a <a>Thing</a> to a <a>Consumer</a>.
              </td>
            </tr>
            <tr>
              <td><code>operation</code></td>
              <td>string</td>
              <td>"observeproperty"</td>
              <td>A string which denotes that this message relates to an <code>observeproperty</code> operation.
              </td>
            </tr>
            <tr>
              <td><code>name</code></td>
              <td>string</td>
              <td>Mandatory</td>
              <td>The name of the <a>Property</a> being observed, as per its key in the <code>properties</code> member
                of the <a>Thing Description</a>.
              </td>
            </tr>
          </tbody>
        </table>
        <pre class="example" title="observeproperty response message">
          {
            "thingID": "https://mythingserver.com/things/mylamp1",
            "messageID": "4df7faaf-6099-4766-a615-cb49883edfd4",
            "messageType": "response",
            "operation": "observeproperty",
            "name": "level",
            "correlationID": "3b380f3c-4fb8-4dc0-8ef2-ef2c2b528931"
          }
        </pre>
      </section>
      <section id="observeproperty-notification">
        <h4>Notification</h4>
        <p>Whilst a property observation subscription is registered, whenever a change in the value of the observed
          <a>Property</a> occurs, the <a>Thing</a> MUST send a message to the observing <a>Consumer</a>
          containing the following members:
        </p>
        <table class="def">
          <caption>Members of an <code>observeproperty</code> notification message</caption>
          <thead>
            <tr>
              <th>Member</th>
              <th>Type</th>
              <th>Assignment</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>messageType</code></td>
              <td>string</td>
              <td>"notification"</td>
              <td>A string which denotes that this message is a notification sent from a <a>Thing</a> to a
                <a>Consumer</a>.
              </td>
            </tr>
            <tr>
              <td><code>operation</code></td>
              <td>string</td>
              <td>"observeproperty"</td>
              <td>A string which denotes that this message relates to an <code>observeproperty</code> operation.
              </td>
            </tr>
            <tr>
              <td><code>name</code></td>
              <td>string</td>
              <td>Mandatory</td>
              <td>The name of the <a>Property</a> being observed, as per its key in the <code>properties</code> member
                of the <a>Thing Description</a>.
              </td>
            </tr>
            <tr>
              <td><code>value</code></td>
              <td>any</td>
              <td>Mandatory</td>
              <td>The current value of the <a>Property</a> being observed, with a type and structure conforming to the
                data
                schema of the corresponding PropertyAffordance in the <a>Thing Description</a>.</td>
            </tr>
            <tr>
              <td><code>timestamp</code></td>
              <td>string</td>
              <td>Optional</td>
              <td>A timestamp in date-time format [[RFC3339]] set to the time the change in value took place.</td>
            </tr>
          </tbody>
        </table>
        <pre class="example" title="observeproperty notification message">
          {
            "thingID": "https://mythingserver.com/things/mylamp1",
            "messageID": "c9cce575-1923-441b-88cb-e58d4f7e615f",
            "messageType": "notification",
            "operation": "observeproperty",
            "name": "level",
            "value": 42,
            "timestamp": "2025-08-20T11:54:25.535Z",
            "correlationID": "3b380f3c-4fb8-4dc0-8ef2-ef2c2b528931"
          }
        </pre>
        <p class="note" title="One notification per property change per connection">
          Because a duplicate observation subscription replaces a previous subscription to the same Property,
          a Thing should only ever send one notification message per WebSocket connection for each change in
          property value. Notification messages always use the <code>correllationID</code> of the currently
          active observation subscription (which may have replaced a previous subscription).
        </p>
      </section>
    </section>

    <section id="unobserveproperty">
      <h3><code>unobserveproperty</code></h3>
      <section id="unobserveproperty-request">
        <h4>Request</h4>
        <p>To stop observing a <a>Property</a>, a <a>Consumer</a> MUST send a <a href="#websocket-messages">message</a>
          to the
          <a>Thing</a> which contains the following members:
        </p>
        <table class="def">
          <caption>Members of an <code>unobserveproperty</code> request message</caption>
          <thead>
            <tr>
              <th>Member</th>
              <th>Type</th>
              <th>Assignment</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>messageType</code></td>
              <td>string</td>
              <td>"request"</td>
              <td>A string which denotes that this message is a request sent from a Consumer to a Thing.</td>
            </tr>
            <tr>
              <td><code>operation</code></td>
              <td>string</td>
              <td>"unobserveproperty"</td>
              <td>A string which denotes that this message relates to an <code>unobserveproperty</code> operation.
              </td>
            </tr>
            <tr>
              <td><code>name</code></td>
              <td>string</td>
              <td>Mandatory</td>
              <td>The name of the <a>Property</a> to stop observing, as per its key in the <code>properties</code>
                member
                of the <a>Thing Description</a>.
              </td>
            </tr>
          </tbody>
        </table>
        <pre class="example" title="unobserveproperty request message">
        {
          "thingID": "https://mythingserver.com/things/mylamp1",
          "messageID": "85afa9c1-b5d1-479a-9a80-ce272b156dff",
          "messageType": "request",
          "operation": "unobserveproperty",
          "name": "level",
          "correlationID": "6180212a-8b28-49fa-9bfc-89c8c43ce887"
        }
      </pre>
        <p>When a <a>Thing</a> receives a message from a <a>Consumer</a> with <code>messageType</code> set to
          <code>request</code> and <code>operation</code> set to <code>unobserveproperty</code> it MUST
          attempt to remove any observation subscription to the <a>Property</a> with the given <code>name</code>.
        </p>
        <p class="note" title="Interaction between unobserveproperty and observeallproperties">
          If an <code>unobserveproperty</code> request removes an observation subscription that was previously
          registered by an <code>observeallproperties</code> operation then that does not impact active observation
          subscriptions for other Properties that may have been registered by the same operation.
        </p>
      </section>
      <section id="unobserveproperty-response">
        <h4>Response</h4>
        <p>Upon successfully removing an observation subscription to the requested <a>Property</a>, the Thing MUST
          send a message to the requesting <code>Consumer</code> containing the following members:</p>
        <table class="def">
          <caption>Members of an <code>unobserveproperty</code> response message</caption>
          <thead>
            <tr>
              <th>Member</th>
              <th>Type</th>
              <th>Assignment</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>messageType</code></td>
              <td>string</td>
              <td>"response"</td>
              <td>A string which denotes that this message is a response sent from a <a>Thing</a> to a
                <a>Consumer</a>.
              </td>
            </tr>
            <tr>
              <td><code>operation</code></td>
              <td>string</td>
              <td>"unobserveproperty"</td>
              <td>A string which denotes that this message relates to an <code>unobserveproperty</code> operation.
              </td>
            </tr>
            <tr>
              <td><code>name</code></td>
              <td>string</td>
              <td>Mandatory</td>
              <td>The name of the <a>Property</a> no longer being observed, as per its key in the
                <code>properties</code> member of the <a>Thing Description</a>.
              </td>
            </tr>
          </tbody>
        </table>
        <pre class="example" title="unobserveproperty response message">
        {
          "thingID": "https://mythingserver.com/things/mylamp1",
          "messageID": "2e6a9454-ac50-4c8a-9c1e-4380c5a05963",
          "messageType": "response",
          "operation": "unobserveproperty",
          "name": "level",
          "correlationID": "6180212a-8b28-49fa-9bfc-89c8c43ce887"
        }
        </pre>
        <p>If a <a>Thing</a> receives an <code>unobserveproperty</code> request for a <a>Property</a>, but that
          <a>Property</a> does not have any active observation subscriptions over the current WebSocket connection, then
          it SHOULD still send a success response since the intended outcome has been achieved.
        </p>
      </section>
    </section>

    <section id="observeallproperties">
      <h3><code>observeallproperties</code></h3>
      <section id="observeallproperties-request">
        <h4>Request</h4>
        <p>To observe all <a>Properties</a> of a <a>Thing</a>, a <a>Consumer</a> MUST send a
          <a href="#websocket-messages">message</a> to the <a>Thing</a> which contains the following members:
        </p>
        <table class="def">
          <caption>Members of an <code>observeallproperties</code> request message</caption>
          <thead>
            <tr>
              <th>Member</th>
              <th>Type</th>
              <th>Assignment</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>messageType</code></td>
              <td>string</td>
              <td>"request"</td>
              <td>A string which denotes that this message is a request sent from a Consumer to a Thing.</td>
            </tr>
            <tr>
              <td><code>operation</code></td>
              <td>string</td>
              <td>"observeallproperties"</td>
              <td>A string which denotes that this message relates to an <code>observeallproperties</code> operation.
              </td>
            </tr>
          </tbody>
        </table>
        <pre class="example" title="observeallproperties request message">
          {
            "thingID": "https://mythingserver.com/things/mylamp1",
            "messageID": "b8988514-5a26-474f-9895-df20db848dd1",
            "messageType": "request",
            "operation": "observeallproperties",
            "correlationID": "e8948c71-b460-46f8-b4e5-f93b04c6e67b"
          }
        </pre>
        <p>When a <a>Thing</a> receives a message from a <a>Consumer</a> with <code>messageType</code> set to
          <code>request</code> and <code>operation</code> set to <code>observeallproperties</code> it MUST
          attempt to register an observation subscription for each <a>Property</a> of the <a>Thing</a>.
        </p>
        <p>If a <a>Thing</a> receives an <code>observeallproperties</code> request and there are already active
          <a>Property</a> observation subscriptions on the same WebSocket connection, the <a>Thing</a> MUST replace
          the existing observation subscriptions with new ones, using the <code>correllationID</code> of the
          <code>observeallproperties</code> request received (i.e. last subscription wins).
        </p>
        <p class="note" title="observeallproperties is a batch operation">
          The <code>observeallproperties</code> operation can be thought of as a batch operation which adds individual
          observation subscriptions to each Property. Those observation subscriptions may later be individually replaced
          by new observation subscriptions using <code>observeproperty</code> operations, or individually cancelled
          using <code>unobserveproperty</code> operations.
        </p>
      </section>
      <section id="observeallproperties-response">
        <h4>Response</h4>
        <p>Upon successfully registering an observation subscription to all <a>Properties</a>, the Thing MUST
          send a message to the requesting <code>Consumer</code> containing the following members:</p>
        <table class="def">
          <caption>Members of an <code>observeallproperties</code> response message</caption>
          <thead>
            <tr>
              <th>Member</th>
              <th>Type</th>
              <th>Assignment</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>messageType</code></td>
              <td>string</td>
              <td>"response"</td>
              <td>A string which denotes that this message is a response sent from a <a>Thing</a> to a <a>Consumer</a>.
              </td>
            </tr>
            <tr>
              <td><code>operation</code></td>
              <td>string</td>
              <td>"observeallproperties"</td>
              <td>A string which denotes that this message relates to an <code>observeallproperties</code> operation.
              </td>
            </tr>
          </tbody>
        </table>
        <pre class="example" title="observeallproperties response message">
          {
            "thingID": "https://mythingserver.com/things/mylamp1",
            "messageID": "0855374a-328d-4a7a-8d46-560d915985f0",
            "messageType": "response",
            "operation": "observeallproperties",
            "correlationID": "e8948c71-b460-46f8-b4e5-f93b04c6e67b"
          }
        </pre>
      </section>
      <section id="observeallproperties-notification">
        <h4>Notification</h4>
        <p>Whilst an observation subscription to all properties is registered, whenever a change in the value of any
          <a>Property</a> of the <a>Thing</a> occurs, the <a>Thing</a> MUST send a message to the observing
          <a>Consumer</a> containing the following members:
        </p>
        <table class="def">
          <caption>Members of an <code>observeallproperties</code> notification message</caption>
          <thead>
            <tr>
              <th>Member</th>
              <th>Type</th>
              <th>Assignment</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>messageType</code></td>
              <td>string</td>
              <td>"notification"</td>
              <td>A string which denotes that this message is a notification sent from a <a>Thing</a> to a
                <a>Consumer</a>.
              </td>
            </tr>
            <tr>
              <td><code>operation</code></td>
              <td>string</td>
              <td>"observeallproperties"</td>
              <td>A string which denotes that this message relates to an <code>observeallproperties</code> operation.
              </td>
            </tr>
            <tr>
              <td><code>name</code></td>
              <td>string</td>
              <td>Mandatory</td>
              <td>The name of the <a>Property</a> whose value changed, as per its key in the <code>properties</code>
                member of the <a>Thing Description</a>.
              </td>
            </tr>
            <tr>
              <td><code>value</code></td>
              <td>any</td>
              <td>Mandatory</td>
              <td>The current value of the <a>Property</a> that changed, with a type and structure conforming to the
                data schema of the corresponding PropertyAffordance in the <a>Thing Description</a>.</td>
            </tr>
            <tr>
              <td><code>timestamp</code></td>
              <td>string</td>
              <td>Optional</td>
              <td>A timestamp in date-time format [[RFC3339]] set to the time the change in value took place.</td>
            </tr>
          </tbody>
        </table>
        <pre class="example" title="observeallproperties notification message">
          {
            "thingID": "https://mythingserver.com/things/mylamp1",
            "messageID": "c351f404-f058-48fe-9c6c-9555fffb4619",
            "messageType": "notification",
            "operation": "observeallproperties",
            "name": "level",
            "value": 42,
            "timestamp": "2025-09-03T12:24:64.532Z",
            "correlationID": "e8948c71-b460-46f8-b4e5-f93b04c6e67b"
          }
        </pre>
        <p class="note" title="One notification per property change per connection">
          Because a duplicate observation subscription replaces a previous subscription to the same Property,
          a Thing should only ever send one notification message per WebSocket connection for each change in
          property value. Notification messages always use the <code>correllationID</code> of the currently
          active observation subscription (which may have replaced a previous subscription).
        </p>
      </section>
    </section>

    <section id="unobserveallproperties">
      <h3><code>unobserveallproperties</code></h3>
      <section id="unobserveallproperties-request">
        <h4>Request</h4>
        <p>To stop observing all <a>Properties</a> of a <a>Thing</a>, a <a>Consumer</a> MUST send a
          <a href="#websocket-messages">message</a> to the <a>Thing</a> which contains the following members:
        </p>
        <table class="def">
          <caption>Members of an <code>unobserveallproperties</code> request message</caption>
          <thead>
            <tr>
              <th>Member</th>
              <th>Type</th>
              <th>Assignment</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>messageType</code></td>
              <td>string</td>
              <td>"request"</td>
              <td>A string which denotes that this message is a request sent from a Consumer to a Thing.</td>
            </tr>
            <tr>
              <td><code>operation</code></td>
              <td>string</td>
              <td>"unobserveallproperties"</td>
              <td>A string which denotes that this message relates to an <code>unobserveallproperties</code> operation.
              </td>
            </tr>
          </tbody>
        </table>
        <pre class="example" title="unobserveallproperties request message">
          {
            "thingID": "https://mythingserver.com/things/mylamp1",
            "messageID": "38794cc1-ff97-494c-b662-7fcf951802a7",
            "messageType": "request",
            "operation": "unobserveallproperties",
            "correlationID": "51f2692b-b707-4097-9077-e313761406aa"
          }
        </pre>
        <p>When a <a>Thing</a> receives a message from a <a>Consumer</a> with <code>messageType</code> set to
          <code>request</code> and <code>operation</code> set to <code>unobserveallproperties</code> it MUST
          attempt to remove observation subscriptions from all <a>Properties</a> of the <a>Thing</a>.
        </p>
        <p class="note" title="unobserveallproperties is a batch operation">
          The <code>unobserveallproperties</code> operation can be thought of as a batch operation which removes
          all individual observation subscriptions that have been registered with a Thing over a given WebSocket
          connection, regardless of whether those observation subscriptions were registered using an
          <code>observeproperty</code> operation or an <code>observeallproperties</code> operation.
        </p>
      </section>
      <section id="unobserveallproperties-response">
        <h4>Response</h4>
        <p>Upon successfully removing observation subscriptions from all <a>Properties</a>, the <a>Thing</a> MUST
          send a message to the requesting <a>Consumer</a> containing the following members:</p>
        <table class="def">
          <caption>Members of an <code>unobserveallproperties</code> response message</caption>
          <thead>
            <tr>
              <th>Member</th>
              <th>Type</th>
              <th>Assignment</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>messageType</code></td>
              <td>string</td>
              <td>"response"</td>
              <td>A string which denotes that this message is a response sent from a <a>Thing</a> to a <a>Consumer</a>.
              </td>
            </tr>
            <tr>
              <td><code>operation</code></td>
              <td>string</td>
              <td>"unobserveallproperties"</td>
              <td>A string which denotes that this message relates to an <code>unobserveallproperties</code> operation.
              </td>
            </tr>
          </tbody>
        </table>
        <pre class="example" title="unobserveallproperties response message">
          {
            "thingID": "https://mythingserver.com/things/mylamp1",
            "messageID": "ec6ad624-74fe-402e-a009-114b779d1bb0",
            "messageType": "response",
            "operation": "unobserveallproperties",
            "correlationID": "51f2692b-b707-4097-9077-e313761406aa"
          }
        </pre>
        <p>If a <a>Thing</a> receives an <code>unobserveallproperties</code> request but the <a>Thing</a> does not have
          any active observation subscriptions over the current WebSocket connection, then it SHOULD still send a
          success response since the intended outcome has been achieved.
        </p>
      </section>
    </section>

    <section id="invokeaction">
      <h3><code>invokeaction</code></h3>
      <section id="invokeaction-request">
        <h4>Request</h4>
        <p>To invoke an <a>Action</a> on a <a>Thing</a>, a <a>Consumer</a> MUST send a <a
            href="#websocket-messages">message</a> to the <a>Thing</a>
          which contains the following members:</p>
        <table class="def">
          <caption>Members of an <code>invokeaction</code> request message</caption>
          <thead>
            <tr>
              <th>Member</th>
              <th>Type</th>
              <th>Assignment</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>messageType</code></td>
              <td>string</td>
              <td>"request"</td>
              <td>A string which denotes that this message is a request sent from a Consumer to a Thing.</td>
            </tr>
            <tr>
              <td><code>operation</code></td>
              <td>string</td>
              <td>"invokeaction"</td>
              <td>A string which denotes that this message relates to an <code>invokeaction</code> operation.</td>
            </tr>
            <tr>
              <td><code>name</code></td>
              <td>string</td>
              <td>Mandatory</td>
              <td>The name of the <a>Action</a> to invoke, as per its key in the <code>actions</code> member of
                the <a>Thing Description</a>.
              </td>
            </tr>
            <tr>
              <td><code>input</code></td>
              <td>any</td>
              <td>Optional</td>
              <td>An input to the <a>Action</a>, with a type and structure conforming to the data schema defined in the
                <code>input</code> member of the corresponding ActionAffordance in the <a>Thing Description</a>.
              </td>
            </tr>
          </tbody>
        </table>
        <pre class="example" title="invokeaction request message">
          {
            "thingID": "https://mythingserver.com/things/mylamp1",
            "messageID": "ff29aac5-062a-4583-9044-be2d45d6ad57",
            "messageType": "request",
            "operation": "invokeaction",
            "name": "fade",
            "input": {
              "level": 100,
              "duration": 5
            }
            "correlationID": "50d5f441-cb07-4513-80b4-cd062cddc1e0"
          }
        </pre>
        <p>When a <a>Thing</a> receives a message from a <a>Consumer</a> with <code>messageType</code> set to
          <code>request</code> and <code>operation</code> set to <code>invokeaction</code> it MUST
          attempt to invoke the <a>Action</a> with the given <code>name</code>, using the provided <code>input</code>
          (if any).
        </p>
      </section>
      <section id="invokeaction-notification">
        <h4>Notification</h4>
        <p>Once a <a>Thing</a> has accepted an <code>invokeaction</code> request, it MAY send one or more notification
          messages to the requesting <a>Consumer</a> with the following members, in order to update the <a>Consumer</a>
          of the status of the ongoing action instance:
        </p>
        <table class="def">
          <caption>Members of an <code>invokeaction</code> notification message</caption>
          <thead>
            <tr>
              <th>Member</th>
              <th>Type</th>
              <th>Assignment</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>messageType</code></td>
              <td>string</td>
              <td>"notification"</td>
              <td>A string which denotes that this message is a notification sent from a <a>Thing</a> to a
                <a>Consumer</a>.
              </td>
            </tr>
            <tr>
              <td><code>operation</code></td>
              <td>string</td>
              <td>"invokeaction"</td>
              <td>A string which denotes that this message relates to an <code>invokeaction</code> operation.</td>
            </tr>
            <tr>
              <td><code>name</code></td>
              <td>string</td>
              <td>Mandatory</td>
              <td>The name of the requested <a>Action</a>, as per its key in the <code>actions</code> member of
                the <a>Thing Description</a>.
              </td>
            </tr>
            <tr>
              <td><code>status</code></td>
              <td>string</td>
              <td>Mandatory</td>
              <td>The current status of the ongoing action instance, set to "pending" if the action has not yet started,
                or "running" if the action is in progress but not yet completed.
              </td>
            </tr>
            <tr>
              <td><code>timeRequested</code></td>
              <td>string</td>
              <td>Optional</td>
              <td>A timestamp in date-time format [[RFC3339]] set to the time the action request was received.</td>
            </tr>
            <tr>
              <td><code>actionID</code></td>
              <td>string</td>
              <td>Mandatory</td>
              <td>A unique identifier in UUIDv4 format [[rfc9562]] which identifies the individual action instance.</td>
            </tr>
          </tbody>
        </table>
        <pre class="example" title="invokeaction notification message">
          {
            "thingID": "https://mythingserver.com/things/mylamp1",
            "messageID": "ec391d5c-b650-4cb6-9069-09dfb794a0f6",
            "messageType": "notification",
            "operation": "invokeaction",
            "name": "fade",
            "status": "running",
            "timeRequested": "2025-09-03T18:14:50.641Z",
            "actionID": "d95100b9-decc-4b11-81b8-81870597ebeb",
            "correlationID": "50d5f441-cb07-4513-80b4-cd062cddc1e0"
          }
        </pre>
        <p class="note" title="Action status">
          Multiple notifications may be sent to a Consumer to update it on the progress of an ongoing action.
          For example, a Thing may send a notification message with <code>status</code> set to "pending" once the
          requested action has been queued, then another notification with <code>status</code> set to "running"
          once the action has been started. If there is no queue or multiple instances of an action can be executed
          concurrently it may skip directly to the "running" state. The completion of an action should be reported
          with a final response message as defined below.
        </p>
        <p class="note" title="actionID">
          The <code>actionID</code> is a unique identifier for an individual instance of an action which may
          be used to identify that action instance across multiple operations (e.g. to query or cancel an ongoing
          action). It is therefore useful to send a notification message to a Consumer as soon as an action request
          has been accepted so that the Consumer has an <code>actionID</code> to use in other operations.
        </p>
      </section>
      <section id="invokeaction-response">
        <h4>Response</h4>
        <p>Upon successful completion of the invoked <a>Action</a>, the Thing MUST send a message to the
          requesting <code>Consumer</code> containing the following members:</p>
        <table class="def">
          <caption>Members of an <code>invokeaction</code> response message</caption>
          <thead>
            <tr>
              <th>Member</th>
              <th>Type</th>
              <th>Assignment</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>messageType</code></td>
              <td>string</td>
              <td>"response"</td>
              <td>A string which denotes that this message is a response sent from a <a>Thing</a> to a <a>Consumer</a>.
              </td>
            </tr>
            <tr>
              <td><code>operation</code></td>
              <td>string</td>
              <td>"invokeaction"</td>
              <td>A string which denotes that this message relates to an <code>invokeaction</code> operation.
              </td>
            </tr>
            <tr>
              <td><code>name</code></td>
              <td>string</td>
              <td>Mandatory</td>
              <td>The name of the <a>Action</a> that was invoked, as per its key in the <code>actions</code> member of
                the <a>Thing Description</a>.
              </td>
            </tr>
            <tr>
              <td><code>status</code></td>
              <td>string</td>
              <td>"completed"</td>
              <td>The current status of the action instance, set to "completed".
              </td>
            </tr>
            <tr>
              <td><code>output</code></td>
              <td>any</td>
              <td>Optional</td>
              <td>The output (if any) of the <a>Action</a> invoked, with a type and structure conforming to the data
                schema specified in the <code>output</code> member of the corresponding ActionAffordance in the
                <a>Thing Description</a>.
              </td>
            </tr>
            <tr>
              <td><code>timeRequested</code></td>
              <td>string</td>
              <td>Optional</td>
              <td>A timestamp in date-time format [[RFC3339]] set to the time the action request was received.</td>
            </tr>
            <tr>
              <td><code>timeEnded</code></td>
              <td>string</td>
              <td>Optional</td>
              <td>A timestamp in date-time format [[RFC3339]] set to the time the action instance was completed.</td>
            </tr>
            <tr>
              <td><code>actionID</code></td>
              <td>string</td>
              <td>Mandatory</td>
              <td>A unique identifier in UUIDv4 format [[rfc9562]] which identifies the individual action instance.</td>
            </tr>
          </tbody>
        </table>
        <pre class="example" title="invokeaction response message">
          {
            "thingID": "https://mythingserver.com/things/mylamp1",
            "messageID": "e47c3727-d68b-4284-a2cc-5883d8fa43a4",
            "messageType": "response",
            "operation": "invokeaction",
            "name": "fade",
            "status": "completed",
            "output": true,
            "timeRequested": "2025-09-03T18:14:50.641Z",
            "timeEnded": "2025-09-03T18:14:55.641Z",
            "actionID": "d95100b9-decc-4b11-81b8-81870597ebeb",
            "correlationID": "50d5f441-cb07-4513-80b4-cd062cddc1e0"
          }
        </pre>
      </section>
      <section id="invokeaction-error-response">
        <h4>Error Response</h4>
        <p>If the <a>Thing</a> fails to complete the requested <a>Action</a> it MUST send an
          <a href="#error-response">error response</a> message to the
          requesting <a>Consumer</a> with a <code>status</code> member set to "failed",
          an <code>actionID</code> member set to the unique identifier for the action instance
          and optional <code>timeRequested</code> and <code>timeEnded</code> members containing
          timestamps for when the action was requested and failed respectively.
        </p>
        <pre class="example" title="invokeaction error response message">
          {
            "thingID": "https://mythingserver.com/things/mylamp1",
            "messageID": "5478d805-bb72-432d-8c84-f05b114eeaba",
            "messageType": "response",
            "operation": "invokeaction",
            "status": "failed",
            "timeRequested": "2025-09-03T18:14:50.641Z",
            "timeEnded": "2025-09-03T18:14:55.641Z",
            "error": {
              "status": "500",
              "type": "https://w3c.github.io/web-thing-protocol/errors#500",
              "title": "Internal Server Error"
              "detail": "The Thing was unable to complete the requested 'fade' action"
            }
            "actionID": "d95100b9-decc-4b11-81b8-81870597ebeb",
            "correlationID": "50d5f441-cb07-4513-80b4-cd062cddc1e0"
          }
        </pre>
      </section>
    </section>

    <section id="error-response">
      <h3>Error Response</h3>
      <p>If a <a>Thing</a> experiences an error when attempting to carry out an operation requested by a
        <a>Consumer</a>,
        it MUST send a response message to the <a>Consumer</a> containing the following members:
      </p>
      <table class="def">
        <caption>Members of an error response message</caption>
        <thead>
          <tr>
            <th>Member</th>
            <th>Type</th>
            <th>Assignment</th>
            <th>Description</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><code>messageType</code></td>
            <td>string</td>
            <td>"response"</td>
            <td>A string which denotes that this message is a response sent from a <a>Thing</a> to a <a>Consumer</a>.
            </td>
          </tr>
          <tr>
            <td><code>error</code></td>
            <td>object</td>
            <td>Mandatory</td>
            <td>An object conforming to the Problem Details Format [[RFC9457]].</td>
          </tr>
        </tbody>
      </table>
      <pre class="example" title="Example error response message">
        <code>
          {
            "thingID": "https://mythingserver.com/things/mylamp1",
            "messageID": "79057736-3e0e-4dc3-b139-a33051901ee2",
            "messageType": "response",
            "operation": "readproperty",
            "name": "on",
            "error": {
              "status": "404",
              "type": "https://w3c.github.io/web-thing-protocol/errors#404",
              "title": "Not Found"
              "detail": "No property found with the name 'on'"
            }
            "timestamp": "2024-01-13T23:20:50.52Z",
            "correlationID": "5afb752f-8be0-4a3c-8108-1327a6009cbd"
          }
        </code>
      </pre>
      <p>If the error experienced could be described by one of the common error types described in the following table
        then that error type SHOULD be used:</p>
      <table class="def">
        <caption>Common error types</caption>
        <thead>
          <tr>
            <th><code>status</code></th>
            <th><code>type</code></th>
            <th><code>title</code></th>
            <th>Description</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>400</td>
            <td>https://w3c.github.io/web-thing-protocol/errors#400</td>
            <td>Bad Request</td>
            <td>The request message was invalid (e.g. is missing mandatory members or contains an unknown operation
              type).
            </td>
          </tr>
          <tr>
            <td>403</td>
            <td>https://w3c.github.io/web-thing-protocol/errors#403</td>
            <td>Forbidden</td>
            <td>The requesting Consumer is not have permission to carry out the requested operation.
            </td>
          </tr>
          <tr>
            <td>404</td>
            <td>https://w3c.github.io/web-thing-protocol/errors#404</td>
            <td>Not Found</td>
            <td>The interaction affordance referenced in the request message can not be found (e.g. no <a>Property</a>
              with the given <code>name</code> exists).
            </td>
          </tr>
          <tr>
            <td>500</td>
            <td>https://w3c.github.io/web-thing-protocol/errors#500</td>
            <td>Internal Server Error</td>
            <td>The <a>Thing</a> experienced an unexpected condition which prevented it from fulfilling the requested
              operation.
            </td>
          </tr>
          <tr>
            <td>503</td>
            <td>https://w3c.github.io/web-thing-protocol/errors#503</td>
            <td>Service Unavailable</td>
            <td>The <a>Thing</a> or interaction affordance is currently not able to fulfil the requested operation
              (e.g.
              because it is overloaded or undergoing a firmware update).
            </td>
          </tr>
        </tbody>
      </table>
      <p class="ednote" title="Error type URLs">
        The URLs given for error types in the table above are placeholders and will be replaced in the final version
        of
        this specification.
      </p>
      <p>The <code>error</code> member of an error response message MAY contain a <code>detail</code> member with its
        value set to a string containing additional human-readable information about the specific instance of the
        error.
      </p>
      <p>A <a>Thing</a> MAY use its own error types where one of the common error types above does not sufficiently
        explain the error, as long as the <code>error</code> member of the response message conforms to the Problem
        Details Format [[RFC9457]].</p>
      <pre class="example" title="Example custom error response message">
        <code>
          {
            "thingID": "https://mythingserver.com/things/teapot",
            "messageID": "07de640d-1b10-4857-b1ae-0c29d62acedc",
            "messageType": "response",
            "operation": "invokeaction",
            "name": "brewCoffee",
            "error": {
              "status": "418",
              "type": "https://mythingserver.com/errors#418",
              "title": "I'm a teapot"
              "detail": "This device can not brew coffee because it is a teapot"
            }
            "timestamp": "2025-05-22T07:21:50.53Z",
            "correlationID": "61aa2164-b1ef-4585-aa3f-626a7f4a185f"
          }
        </code>
      </pre>
    </section>

  </section>

  <section id="example-thing-descriptions">
    <h2>Example Thing Descriptions</h2>
  </section>

  <section id="privacy-considerations">
    <h2>Privacy Considerations</h2>
  </section>

  <section id="security-considerations">
    <h2>Security Considerations</h2>
  </section>

  <section id="accessibility-considerations">
    <h2>Accessibility Considerations</h2>
  </section>

  <section id="iana-considerations">
    <h2>IANA Considerations</h2>
    <p>This specification proposes the registration of a sub-protocol in the IANA &quot;<a
        href="https://www.iana.org/assignments/websocket/websocket.xml">WebSocket Subprotocol Name Registry</a>&quot;.
      The name of the sub-protocol and the published URL of its definition are to be confirmed, but currently the name
      &quot;webthingprotocol&quot; and this document are used as a placeholder and draft proposal.</p>
    <dl>
      <dt>Subprotocol Identifier</dt>
      <dd>webthingprotocol</dd>

      <dt>Subprotocol Common Name</dt>
      <dd>Web Thing Protocol</dd>

      <dt>Subprotocol Definition</dt>
      <dd>This document.</dd>
    </dl>
  </section>

</body>

</html>